name: EAS Android Build

on:
  push:
    branches:
      - production # ØºÙŠÙ‘Ø±Ù‡ Ù„ÙØ±Ø¹ Ø¢Ø®Ø± Ù…Ø«Ù„ release Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ¹Ù…Ù„ Ø¨Ù†Ø¸Ø§Ù… ÙØ±ÙˆØ¹
  workflow_dispatch: # ÙŠØ³Ù…Ø­ Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ù…Ù† GitHub

jobs:
  eas-android-build:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† GitHub
        uses: actions/checkout@v3

      - name: ğŸ§° ØªØ«Ø¨ÙŠØª Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      - name: ğŸš€ ØªØ«Ø¨ÙŠØª EAS CLI
        run: npm install -g eas-cli

      - name: ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Expo Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªÙˆÙƒÙ†
        env:
          EXPO_TOKEN: ${{ secrets.EXPO_TOKEN }}
        run: eas whoami || echo "âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"

      - name: ğŸ“¦ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø²Ù…
        run: npm ci

      - name: ğŸ¤– ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ù†Ø§Ø¡ Ù„Ø£Ù†Ø¯Ø±ÙˆÙŠØ¯
        env:
          EXPO_TOKEN: ${{ secrets.EXPO_TOKEN }}
        run: eas build --platform android --profile production --non-interactive
